{"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/pushwooshcore\/pwconfiguration\/setpurchasedelegate:"],"traits":[{"interfaceLanguage":"occ"}]}],"identifier":{"interfaceLanguage":"occ","url":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration\/setPurchaseDelegate:"},"hierarchy":{"paths":[["doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore","doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration"]]},"primaryContentSections":[{"declarations":[{"platforms":["iOS"],"tokens":[{"kind":"text","text":"+ ("},{"text":"void","kind":"typeIdentifier","preciseIdentifier":"c:v"},{"kind":"text","text":") "},{"text":"setPurchaseDelegate:","kind":"identifier"},{"text":"(","kind":"text"},{"kind":"typeIdentifier","text":"id<PWPurchaseDelegate>","preciseIdentifier":"c:Qoobjc(pl)PWPurchaseDelegate"},{"kind":"text","text":") "},{"kind":"internalParam","text":"delegate"},{"text":";","kind":"text"}],"languages":["occ"]}],"kind":"declarations"},{"kind":"parameters","parameters":[{"name":"delegate","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Object implementing PWPurchaseDelegate protocol, or nil to remove the delegate"}]}]}]},{"content":[{"anchor":"discussion","level":2,"type":"heading","text":"Discussion"},{"inlineContent":[{"type":"text","text":"The delegate will receive callbacks for in-app purchase events triggered from"},{"type":"text","text":" "},{"type":"text","text":"Pushwoosh rich media content (HTML pages, in-app messages)."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This enables:"}]},{"items":[{"content":[{"inlineContent":[{"text":"Handling promoted purchases from the App Store","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Processing purchases initiated from rich media","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Tracking purchase completions and failures"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Restoring previous purchases","type":"text"}]}]}],"type":"unorderedList"},{"level":2,"type":"heading","anchor":"Example","text":"Example"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Handle in-app purchases from rich media:"}]},{"type":"codeListing","syntax":"swift","code":["class PurchaseCoordinator: NSObject, PWPurchaseDelegate {","","    static let shared = PurchaseCoordinator()","","    func setup() {","        Pushwoosh.configure.setPurchaseDelegate(self)","    }","","    \/\/ MARK: - PWPurchaseDelegate","","    func onPW(inAppPurchaseHelperCallPromotedPurchase identifier: String) {","        Logger.info(\"Promoted purchase initiated: \\(identifier)\")","","        \/\/ Verify user is ready to purchase","        guard UserSession.shared.isLoggedIn else {","            \/\/ Save for later and prompt login","            PendingPurchaseManager.shared.save(identifier)","            NavigationCoordinator.shared.showLogin(reason: .purchase)","            return","        }","","        \/\/ Process the purchase","        IAPManager.shared.purchase(productIdentifier: identifier)","    }","","    func onPWInAppPurchaseHelperPaymentComplete(_ identifier: String) {","        Logger.info(\"Purchase completed: \\(identifier)\")","","        \/\/ Update user status","        Pushwoosh.configure.setTags([","            \"last_purchase\": identifier,","            \"last_purchase_date\": Date(),","            \"has_purchased\": true","        ])","","        \/\/ Unlock content","        ContentUnlocker.shared.unlock(identifier)","","        \/\/ Track in analytics","        Analytics.track(\"purchase_completed\", properties: [","            \"product_id\": identifier,","            \"source\": \"rich_media\"","        ])","    }","","    func onPWInAppPurchaseHelperPaymentFailedProductIdentifier(_ identifier: String, error: Error) {","        Logger.error(\"Purchase failed: \\(identifier) - \\(error.localizedDescription)\")","","        Analytics.track(\"purchase_failed\", properties: [","            \"product_id\": identifier,","            \"error\": error.localizedDescription","        ])","    }","}"]}],"kind":"content"}],"abstract":[{"text":"Sets the delegate for in-app purchase events from rich media.","type":"text"}],"metadata":{"externalID":"c:objc(pl)PWConfiguration(cm)setPurchaseDelegate:","role":"symbol","title":"setPurchaseDelegate:","symbolKind":"method","roleHeading":"Type Method","modules":[{"name":"PushwooshCore"}],"fragments":[{"text":"+ ","kind":"text"},{"text":"setPurchaseDelegate:","kind":"identifier"}],"navigatorTitle":[{"text":"setPurchaseDelegate:","kind":"identifier"}]},"kind":"symbol","references":{"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore/PWConfiguration":{"kind":"symbol","title":"PWConfiguration","role":"symbol","type":"topic","fragments":[{"kind":"identifier","text":"PWConfiguration"}],"url":"\/documentation\/pushwooshcore\/pwconfiguration","abstract":[],"identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration"},"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore/PWConfiguration/setPurchaseDelegate:":{"url":"\/documentation\/pushwooshcore\/pwconfiguration\/setpurchasedelegate:","abstract":[{"text":"Sets the delegate for in-app purchase events from rich media.","type":"text"}],"title":"setPurchaseDelegate:","kind":"symbol","identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration\/setPurchaseDelegate:","navigatorTitle":[{"kind":"identifier","text":"setPurchaseDelegate:"}],"role":"symbol","fragments":[{"text":"+ ","kind":"text"},{"text":"setPurchaseDelegate:","kind":"identifier"}],"type":"topic"},"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore":{"type":"topic","role":"collection","title":"PushwooshCore","abstract":[{"type":"text","text":"Core foundation module for Pushwoosh SDK."}],"url":"\/documentation\/pushwooshcore","kind":"symbol","identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore"}}}