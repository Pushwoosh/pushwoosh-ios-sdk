{"primaryContentSections":[{"declarations":[{"platforms":["iOS"],"languages":["occ"],"tokens":[{"kind":"text","text":"+ ("},{"text":"void","kind":"typeIdentifier","preciseIdentifier":"c:v"},{"text":") ","kind":"text"},{"text":"setPurchaseDelegate:","kind":"identifier"},{"kind":"text","text":"("},{"preciseIdentifier":"c:Qoobjc(pl)PWPurchaseDelegate","kind":"typeIdentifier","text":"id<PWPurchaseDelegate>"},{"text":") ","kind":"text"},{"kind":"internalParam","text":"delegate"},{"kind":"text","text":";"}]}],"kind":"declarations"},{"kind":"parameters","parameters":[{"name":"delegate","content":[{"inlineContent":[{"type":"text","text":"Object implementing PWPurchaseDelegate protocol, or nil to remove the delegate"}],"type":"paragraph"}]}]},{"kind":"content","content":[{"type":"heading","level":2,"anchor":"discussion","text":"Discussion"},{"inlineContent":[{"text":"The delegate will receive callbacks for in-app purchase events triggered from","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"Pushwoosh rich media content (HTML pages, in-app messages)."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"This enables:"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Handling promoted purchases from the App Store"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Processing purchases initiated from rich media","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Tracking purchase completions and failures"}]}]},{"content":[{"inlineContent":[{"text":"Restoring previous purchases","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":2,"type":"heading","text":"Example","anchor":"Example"},{"inlineContent":[{"text":"Handle in-app purchases from rich media:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["class PurchaseCoordinator: NSObject, PWPurchaseDelegate {","","    static let shared = PurchaseCoordinator()","","    func setup() {","        Pushwoosh.configure.setPurchaseDelegate(self)","    }","","    \/\/ MARK: - PWPurchaseDelegate","","    func onPW(inAppPurchaseHelperCallPromotedPurchase identifier: String) {","        Logger.info(\"Promoted purchase initiated: \\(identifier)\")","","        \/\/ Verify user is ready to purchase","        guard UserSession.shared.isLoggedIn else {","            \/\/ Save for later and prompt login","            PendingPurchaseManager.shared.save(identifier)","            NavigationCoordinator.shared.showLogin(reason: .purchase)","            return","        }","","        \/\/ Process the purchase","        IAPManager.shared.purchase(productIdentifier: identifier)","    }","","    func onPWInAppPurchaseHelperPaymentComplete(_ identifier: String) {","        Logger.info(\"Purchase completed: \\(identifier)\")","","        \/\/ Update user status","        Pushwoosh.configure.setTags([","            \"last_purchase\": identifier,","            \"last_purchase_date\": Date(),","            \"has_purchased\": true","        ])","","        \/\/ Unlock content","        ContentUnlocker.shared.unlock(identifier)","","        \/\/ Track in analytics","        Analytics.track(\"purchase_completed\", properties: [","            \"product_id\": identifier,","            \"source\": \"rich_media\"","        ])","    }","","    func onPWInAppPurchaseHelperPaymentFailedProductIdentifier(_ identifier: String, error: Error) {","        Logger.error(\"Purchase failed: \\(identifier) - \\(error.localizedDescription)\")","","        Analytics.track(\"purchase_failed\", properties: [","            \"product_id\": identifier,","            \"error\": error.localizedDescription","        ])","    }","}"],"type":"codeListing"}]}],"variants":[{"paths":["\/documentation\/pushwooshcore\/pwconfiguration\/setpurchasedelegate:"],"traits":[{"interfaceLanguage":"occ"}]}],"schemaVersion":{"minor":3,"patch":0,"major":0},"metadata":{"modules":[{"name":"PushwooshCore"}],"externalID":"c:objc(pl)PWConfiguration(cm)setPurchaseDelegate:","symbolKind":"method","role":"symbol","roleHeading":"Type Method","navigatorTitle":[{"kind":"identifier","text":"setPurchaseDelegate:"}],"title":"setPurchaseDelegate:","fragments":[{"text":"+ ","kind":"text"},{"text":"setPurchaseDelegate:","kind":"identifier"}]},"abstract":[{"type":"text","text":"Sets the delegate for in-app purchase events from rich media."}],"sections":[],"hierarchy":{"paths":[["doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore","doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration"]]},"identifier":{"interfaceLanguage":"occ","url":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration\/setPurchaseDelegate:"},"kind":"symbol","references":{"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore/PWConfiguration/setPurchaseDelegate:":{"kind":"symbol","abstract":[{"type":"text","text":"Sets the delegate for in-app purchase events from rich media."}],"url":"\/documentation\/pushwooshcore\/pwconfiguration\/setpurchasedelegate:","type":"topic","role":"symbol","navigatorTitle":[{"text":"setPurchaseDelegate:","kind":"identifier"}],"title":"setPurchaseDelegate:","fragments":[{"text":"+ ","kind":"text"},{"text":"setPurchaseDelegate:","kind":"identifier"}],"identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration\/setPurchaseDelegate:"},"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore/PWConfiguration":{"type":"topic","kind":"symbol","abstract":[],"title":"PWConfiguration","fragments":[{"kind":"identifier","text":"PWConfiguration"}],"identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration","role":"symbol","url":"\/documentation\/pushwooshcore\/pwconfiguration"},"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore":{"role":"collection","url":"\/documentation\/pushwooshcore","identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore","type":"topic","kind":"symbol","title":"PushwooshCore","abstract":[{"type":"text","text":"Core foundation module for Pushwoosh SDK."}]}}}