{"sections":[],"variants":[{"paths":["\/documentation\/pushwooshcore\/pwconfiguration\/sendskpaymenttransactions:"],"traits":[{"interfaceLanguage":"occ"}]}],"hierarchy":{"paths":[["doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore","doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration"]]},"identifier":{"url":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration\/sendSKPaymentTransactions:","interfaceLanguage":"occ"},"abstract":[{"text":"Sends StoreKit payment transactions to Pushwoosh for purchase tracking.","type":"text"}],"metadata":{"role":"symbol","roleHeading":"Type Method","modules":[{"name":"PushwooshCore"}],"title":"sendSKPaymentTransactions:","symbolKind":"method","fragments":[{"kind":"text","text":"+ "},{"kind":"identifier","text":"sendSKPaymentTransactions:"}],"externalID":"c:objc(pl)PWConfiguration(cm)sendSKPaymentTransactions:","navigatorTitle":[{"kind":"identifier","text":"sendSKPaymentTransactions:"}]},"primaryContentSections":[{"kind":"declarations","declarations":[{"tokens":[{"text":"+ (","kind":"text"},{"text":"void","kind":"typeIdentifier","preciseIdentifier":"c:v"},{"kind":"text","text":") "},{"text":"sendSKPaymentTransactions:","kind":"identifier"},{"text":"(","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"c:objc(cs)NSArray","text":"NSArray"},{"kind":"text","text":" *) "},{"text":"transactions","kind":"internalParam"},{"text":";","kind":"text"}],"platforms":["iOS"],"languages":["occ"]}]},{"kind":"parameters","parameters":[{"name":"transactions","content":[{"inlineContent":[{"type":"text","text":"Array of "},{"type":"codeVoice","code":"SKPaymentTransaction"},{"type":"text","text":" objects from StoreKit."}],"type":"paragraph"}]}]},{"kind":"content","content":[{"text":"Discussion","type":"heading","level":2,"anchor":"discussion"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Automatically tracks in-app purchases from StoreKit transactions."},{"text":" ","type":"text"},{"text":"This enables:","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Revenue tracking"}],"type":"strong"},{"type":"text","text":": Monitor purchase revenue in Pushwoosh dashboard"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"Purchase-based segmentation","type":"text"}],"type":"strong"},{"text":": Target paying users, high-value customers","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"LTV analysis"}],"type":"strong"},{"type":"text","text":": Calculate customer lifetime value"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Purchase events","type":"text"}]},{"type":"text","text":": Trigger automations based on purchases"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"text":"Call this method from your ","type":"text"},{"code":"SKPaymentTransactionObserver","type":"codeVoice"},{"text":" for all","type":"text"},{"type":"text","text":" "},{"type":"text","text":"completed transactions."}]},{"level":2,"type":"heading","text":"Example","anchor":"Example"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Integrate with StoreKit payment observer:"}]},{"type":"codeListing","syntax":"swift","code":["class StoreKitManager: NSObject, SKPaymentTransactionObserver {","","    func paymentQueue(_ queue: SKPaymentQueue,","                     updatedTransactions transactions: [SKPaymentTransaction]) {","","        let completedTransactions = transactions.filter {","            $0.transactionState == .purchased || $0.transactionState == .restored","        }","","        \/\/ Send completed transactions to Pushwoosh","        if !completedTransactions.isEmpty {","            Pushwoosh.configure.sendSKPaymentTransactions(completedTransactions)","        }","","        \/\/ Process each transaction","        for transaction in transactions {","            switch transaction.transactionState {","            case .purchased:","                handlePurchase(transaction)","                queue.finishTransaction(transaction)","","            case .restored:","                handleRestore(transaction)","                queue.finishTransaction(transaction)","","            case .failed:","                handleFailure(transaction)","                queue.finishTransaction(transaction)","","            case .deferred, .purchasing:","                break","","            @unknown default:","                break","            }","        }","    }","","    private func handlePurchase(_ transaction: SKPaymentTransaction) {","        let productId = transaction.payment.productIdentifier","","        \/\/ Update user tags for purchase segmentation","        Pushwoosh.configure.setTags([","            \"has_purchased\": true,","            \"last_purchase_date\": ISO8601DateFormatter().string(from: Date()),","            \"last_purchased_product\": productId","        ])","    }","}"]}]}],"kind":"symbol","schemaVersion":{"patch":0,"minor":3,"major":0},"references":{"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore/PWConfiguration/sendSKPaymentTransactions:":{"identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration\/sendSKPaymentTransactions:","kind":"symbol","title":"sendSKPaymentTransactions:","type":"topic","fragments":[{"text":"+ ","kind":"text"},{"kind":"identifier","text":"sendSKPaymentTransactions:"}],"role":"symbol","url":"\/documentation\/pushwooshcore\/pwconfiguration\/sendskpaymenttransactions:","navigatorTitle":[{"text":"sendSKPaymentTransactions:","kind":"identifier"}],"abstract":[{"text":"Sends StoreKit payment transactions to Pushwoosh for purchase tracking.","type":"text"}]},"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore/PWConfiguration":{"url":"\/documentation\/pushwooshcore\/pwconfiguration","title":"PWConfiguration","abstract":[],"fragments":[{"text":"PWConfiguration","kind":"identifier"}],"kind":"symbol","type":"topic","identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration","role":"symbol"},"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore":{"title":"PushwooshCore","url":"\/documentation\/pushwooshcore","kind":"symbol","role":"collection","type":"topic","identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore","abstract":[{"type":"text","text":"Core foundation module for Pushwoosh SDK."}]}}}