{"variants":[{"traits":[{"interfaceLanguage":"occ"}],"paths":["\/documentation\/pushwooshcore\/pwconfiguration\/sendskpaymenttransactions:"]}],"metadata":{"externalID":"c:objc(pl)PWConfiguration(cm)sendSKPaymentTransactions:","fragments":[{"text":"+ ","kind":"text"},{"kind":"identifier","text":"sendSKPaymentTransactions:"}],"title":"sendSKPaymentTransactions:","symbolKind":"method","role":"symbol","roleHeading":"Type Method","modules":[{"name":"PushwooshCore"}],"navigatorTitle":[{"kind":"identifier","text":"sendSKPaymentTransactions:"}]},"abstract":[{"text":"Sends StoreKit payment transactions to Pushwoosh for purchase tracking.","type":"text"}],"primaryContentSections":[{"declarations":[{"tokens":[{"kind":"text","text":"+ ("},{"preciseIdentifier":"c:v","kind":"typeIdentifier","text":"void"},{"text":") ","kind":"text"},{"kind":"identifier","text":"sendSKPaymentTransactions:"},{"text":"(","kind":"text"},{"preciseIdentifier":"c:objc(cs)NSArray","kind":"typeIdentifier","text":"NSArray"},{"text":" *) ","kind":"text"},{"kind":"internalParam","text":"transactions"},{"kind":"text","text":";"}],"platforms":["iOS"],"languages":["occ"]}],"kind":"declarations"},{"kind":"parameters","parameters":[{"name":"transactions","content":[{"inlineContent":[{"type":"text","text":"Array of "},{"code":"SKPaymentTransaction","type":"codeVoice"},{"text":" objects from StoreKit.","type":"text"}],"type":"paragraph"}]}]},{"content":[{"anchor":"discussion","type":"heading","level":2,"text":"Discussion"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Automatically tracks in-app purchases from StoreKit transactions."},{"text":" ","type":"text"},{"type":"text","text":"This enables:"}]},{"items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"Revenue tracking"}],"type":"strong"},{"type":"text","text":": Monitor purchase revenue in Pushwoosh dashboard"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Purchase-based segmentation","type":"text"}]},{"text":": Target paying users, high-value customers","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"LTV analysis"}]},{"type":"text","text":": Calculate customer lifetime value"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Purchase events"}],"type":"strong"},{"text":": Trigger automations based on purchases","type":"text"}]}]}],"type":"unorderedList"},{"inlineContent":[{"type":"text","text":"Call this method from your "},{"type":"codeVoice","code":"SKPaymentTransactionObserver"},{"text":" for all","type":"text"},{"text":" ","type":"text"},{"text":"completed transactions.","type":"text"}],"type":"paragraph"},{"type":"heading","anchor":"Example","text":"Example","level":2},{"type":"paragraph","inlineContent":[{"text":"Integrate with StoreKit payment observer:","type":"text"}]},{"syntax":"swift","code":["class StoreKitManager: NSObject, SKPaymentTransactionObserver {","","    func paymentQueue(_ queue: SKPaymentQueue,","                     updatedTransactions transactions: [SKPaymentTransaction]) {","","        let completedTransactions = transactions.filter {","            $0.transactionState == .purchased || $0.transactionState == .restored","        }","","        \/\/ Send completed transactions to Pushwoosh","        if !completedTransactions.isEmpty {","            Pushwoosh.configure.sendSKPaymentTransactions(completedTransactions)","        }","","        \/\/ Process each transaction","        for transaction in transactions {","            switch transaction.transactionState {","            case .purchased:","                handlePurchase(transaction)","                queue.finishTransaction(transaction)","","            case .restored:","                handleRestore(transaction)","                queue.finishTransaction(transaction)","","            case .failed:","                handleFailure(transaction)","                queue.finishTransaction(transaction)","","            case .deferred, .purchasing:","                break","","            @unknown default:","                break","            }","        }","    }","","    private func handlePurchase(_ transaction: SKPaymentTransaction) {","        let productId = transaction.payment.productIdentifier","","        \/\/ Update user tags for purchase segmentation","        Pushwoosh.configure.setTags([","            \"has_purchased\": true,","            \"last_purchase_date\": ISO8601DateFormatter().string(from: Date()),","            \"last_purchased_product\": productId","        ])","    }","}"],"type":"codeListing"}],"kind":"content"}],"sections":[],"kind":"symbol","schemaVersion":{"minor":3,"major":0,"patch":0},"hierarchy":{"paths":[["doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore","doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration"]]},"identifier":{"url":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration\/sendSKPaymentTransactions:","interfaceLanguage":"occ"},"references":{"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore/PWConfiguration/sendSKPaymentTransactions:":{"url":"\/documentation\/pushwooshcore\/pwconfiguration\/sendskpaymenttransactions:","abstract":[{"type":"text","text":"Sends StoreKit payment transactions to Pushwoosh for purchase tracking."}],"title":"sendSKPaymentTransactions:","kind":"symbol","identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration\/sendSKPaymentTransactions:","navigatorTitle":[{"text":"sendSKPaymentTransactions:","kind":"identifier"}],"role":"symbol","fragments":[{"text":"+ ","kind":"text"},{"kind":"identifier","text":"sendSKPaymentTransactions:"}],"type":"topic"},"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore/PWConfiguration":{"kind":"symbol","title":"PWConfiguration","role":"symbol","type":"topic","fragments":[{"kind":"identifier","text":"PWConfiguration"}],"url":"\/documentation\/pushwooshcore\/pwconfiguration","abstract":[],"identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore\/PWConfiguration"},"doc://com.pushwoosh.PushwooshCore/documentation/PushwooshCore":{"type":"topic","role":"collection","title":"PushwooshCore","abstract":[{"type":"text","text":"Core foundation module for Pushwoosh SDK."}],"url":"\/documentation\/pushwooshcore","kind":"symbol","identifier":"doc:\/\/com.pushwoosh.PushwooshCore\/documentation\/PushwooshCore"}}}